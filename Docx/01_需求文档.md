# MessageIn - 班级消息互动系统需求文档

## 1. 项目概述

MessageIn是一个轻量级的班级消息互动系统，旨在促进老师与学生之间的实时沟通。该系统允许老师通过电脑端向学生班级大屏幕发送消息，消息以弹幕形式在大屏幕上滚动显示。学生可以通过点击确认消息已读，老师则能够实时查看消息的阅读状态。系统设计为web应用，同时支持使用Electron打包为多端桌面应用程序。

### 1.1 项目目标

- 建立一个简单直观的老师-学生消息互动平台
- 提供实时消息发送和状态跟踪功能
- 设计轻量级架构，确保系统运行流畅
- 开发可在多种设备和平台上运行的应用

### 1.2 用户角色

- **管理员**：负责系统配置、用户管理和监控
- **老师**：消息发送者，可查看消息阅读状态
- **学生**：消息接收者，可在大屏幕上查看消息并确认阅读

## 2. 功能需求

### 2.1 管理员功能

#### 2.1.1 用户管理
- 创建、编辑和删除老师账户
- 创建、编辑和删除班级
- 管理班级与老师的关联关系
- 查看系统使用日志

#### 2.1.2 系统配置
- 自定义系统基本设置（如消息保留时间、显示样式等）
- 管理系统公告
- 数据备份与恢复功能

### 2.2 老师功能

#### 2.2.1 消息管理
- 撰写新消息
- 选择目标班级
- 设置消息优先级（普通/重要/紧急）
- 设置消息显示时间
- 编辑或删除未过期的消息
- 查看历史消息记录

#### 2.2.2 消息状态跟踪
- 实时查看消息已读状态
- 查看每条消息的阅读统计（已读人数/总人数）
- 查看具体哪些学生已读/未读
- 导出消息阅读状态报表

#### 2.2.3 班级管理
- 查看所教班级列表
- 查看班级学生名单

### 2.3 学生功能（大屏显示端）

#### 2.3.1 消息显示
- 以弹幕形式滚动显示接收到的消息
- 根据消息优先级显示不同颜色
- 支持消息循环播放功能

#### 2.3.2 消息互动
- 点击消息标记为已读
- 已读消息显示标记（打勾图标）
- 查看历史消息列表

## 3. 技术架构

### 3.1 总体架构

系统采用前后端分离的架构设计：
- 前端：使用Vue.js框架开发web应用，后期使用Electron打包为桌面应用
- 后端：基于Node.js的Express框架开发RESTful API
- 数据库：MongoDB用于存储所有业务数据
- 实时通信：使用WebSocket技术实现消息实时推送

### 3.2 技术栈

#### 3.2.1 前端技术
- HTML5, CSS3, JavaScript
- Vue.js框架 (Vue 3 + Composition API)
- Vue Router用于前端路由
- Vuex/Pinia用于状态管理
- Element Plus UI组件库
- Electron (桌面应用打包)
- Socket.io-client (WebSocket客户端)

#### 3.2.2 后端技术
- Node.js
- Express.js
- MongoDB原生驱动
- Socket.io (WebSocket服务器)
- JWT (身份验证)

### 3.3 部署架构

- 开发环境：本地开发环境
- 测试环境：测试服务器
- 生产环境：云服务器或学校内部服务器
- 客户端分发：Web访问和Electron打包的桌面应用

## 4. 数据库设计

### 4.1 集合设计（MongoDB）

#### 4.1.1 用户集合 (users)
```
{
  _id: ObjectId,
  username: String,  // 用户名
  password: String,  // 加密密码
  name: String,      // 真实姓名
  role: String,      // 角色: admin, teacher, display
  email: String,     // 电子邮箱
  phone: String,     // 联系电话
  avatar: String,    // 头像URL
  createdAt: Date,   // 创建时间
  updatedAt: Date    // 更新时间
}
```

#### 4.1.2 班级集合 (classes)
```
{
  _id: ObjectId,
  name: String,          // 班级名称
  grade: String,         // 年级
  studentCount: Number,  // 学生人数
  teachers: [ObjectId],  // 关联的老师ID数组
  displayId: ObjectId,   // 关联的显示端ID
  createdAt: Date,       // 创建时间
  updatedAt: Date        // 更新时间
}
```

#### 4.1.3 消息集合 (messages)
```
{
  _id: ObjectId,
  content: String,        // 消息内容
  senderId: ObjectId,     // 发送者ID
  classId: ObjectId,      // 目标班级ID
  priority: String,       // 优先级: normal, important, urgent
  status: String,         // 状态: active, expired
  displayDuration: Number, // 显示时长(分钟)
  readCount: Number,      // 已读人数
  createdAt: Date,        // 创建时间
  expiresAt: Date         // 过期时间
}
```

#### 4.1.4 阅读记录集合 (readRecords)
```
{
  _id: ObjectId,
  messageId: ObjectId,  // 关联的消息ID
  classId: ObjectId,    // 班级ID
  readAt: Date,         // 阅读时间
  createdAt: Date       // 创建时间
}
```

#### 4.1.5 系统日志集合 (systemLogs)
```
{
  _id: ObjectId,
  userId: ObjectId,    // 操作用户ID
  action: String,      // 操作类型
  description: String, // 操作描述
  ipAddress: String,   // IP地址
  createdAt: Date      // 创建时间
}
```

## 5. 非功能需求

### 5.1 性能需求
- 页面加载时间不超过3秒
- 消息发送到显示的延迟不超过2秒
- 系统支持同时在线用户数不少于100人
- 数据库能够存储至少一年的消息记录

### 5.2 安全需求
- 所有用户密码必须加密存储
- 使用JWT进行用户身份验证
- API访问权限控制
- 防止常见web安全漏洞(XSS, CSRF等)

### 5.3 可用性需求
- 系统界面简洁直观，易于使用
- 支持响应式设计，适应不同屏幕尺寸
- 系统正常运行时间(Uptime)达到99%
- 提供基本的用户引导和帮助文档

### 5.4 兼容性需求
- Web端支持主流浏览器（Chrome, Firefox, Safari, Edge）
- Electron应用支持Windows 7+, macOS 10.10+, 主流Linux发行版
- 移动端网页适配主流移动设备屏幕

## 6. 界面原型设计

### 6.1 登录界面
- 用户名/密码登录表单
- 角色选择（管理员/老师/显示端）
- 记住密码功能
- 忘记密码功能

### 6.2 管理员控制台
- 左侧导航菜单
- 用户管理界面
- 班级管理界面
- 系统设置界面
- 日志查看界面

### 6.3 老师端消息管理界面
- 消息撰写表单
- 班级选择下拉框
- 消息优先级选择
- 消息列表（显示状态及已读统计）
- 消息详情及已读状态查看

### 6.4 学生端大屏显示界面
- 全屏弹幕显示区域
- 消息根据优先级显示不同颜色
- 点击消息进行已读确认
- 右下角消息历史入口

## 7. 项目里程碑

### 7.1 阶段一：需求分析与设计（2周）
- 完成需求分析文档
- 设计数据库结构
- 完成界面原型设计
- 技术选型确认

### 7.2 阶段二：核心功能开发（4周）
- 完成用户认证系统
- 开发消息发送和接收功能
- 实现实时弹幕显示功能
- 开发消息阅读确认功能

### 7.3 阶段三：管理功能开发（3周）
- 完成用户管理功能
- 开发班级管理功能
- 实现消息统计功能
- 开发系统设置功能

### 7.4 阶段四：测试与优化（2周）
- 进行功能测试
- 进行性能测试
- 修复bug与性能优化
- 用户体验优化

### 7.5 阶段五：部署与培训（1周）
- 系统部署上线
- 编写使用文档
- 进行用户培训
- 收集初期使用反馈

## 8. 项目风险及应对措施

### 8.1 技术风险
- **风险**：实时消息系统的性能和稳定性可能不达预期
- **应对**：进行充分的技术调研和性能测试，选择成熟的WebSocket实现方案

### 8.2 用户接受度风险
- **风险**：教师可能不习惯使用新系统进行消息发送
- **应对**：设计简洁直观的界面，提供详细的使用指南和培训

### 8.3 数据安全风险
- **风险**：学校相关数据可能存在泄露风险
- **应对**：实施严格的数据访问控制和加密措施

### 8.4 系统扩展性风险
- **风险**：随着用户增加，系统可能面临扩展性挑战
- **应对**：采用模块化设计，为未来扩展预留接口

## 9. 附录

### 9.1 术语表
- **弹幕**：在屏幕上滚动显示的文字消息
- **已读确认**：学生点击消息表示已阅读的功能
- **Electron**：用于构建跨平台桌面应用的JavaScript框架
- **MongoDB**：一种文档型NoSQL数据库
- **Vue.js**：渐进式JavaScript前端框架

### 9.2 参考文档
- Vue.js官方文档
- MongoDB官方文档
- Electron官方文档
- WebSocket技术规范
- JWT认证最佳实践指南 