# MessageIn - 系统架构图

```
+---------------------------------------------------+
|                                                   |
|                   客户端层                         |
|                                                   |
|  +-------------+  +-------------+  +-------------+|
|  |             |  |             |  |             ||
|  |  老师Web端/  |  | 管理员Web端/ |  | 学生大屏端/  ||
|  | Electron应用 |  | Electron应用 |  | Electron应用 ||
|  | (Vue.js)    |  | (Vue.js)    |  | (Vue.js)    ||
|  +------+------+  +------+------+  +------+------+|
|         |                |                |       |
+---------+----------------+----------------+-------+
          |                |                |
          v                v                v
+---------------------------------------------------+
|                                                   |
|                     API层                         |
|                                                   |
|  +-------------+  +-------------+  +-------------+|
|  |             |  |             |  |             ||
|  |   用户API    |  |   消息API   |  |   班级API   ||
|  |             |  |             |  |             ||
|  +-------------+  +-------------+  +-------------+|
|                                                   |
|  +-------------+  +-------------+                 |
|  |             |  |             |                 |
|  |  WebSocket  |  |  权限验证    |                 |
|  |    服务     |  |   (JWT)     |                 |
|  |             |  |             |                 |
|  +-------------+  +-------------+                 |
|                                                   |
+----------------------+----------------------------+
                      |
                      v
+---------------------------------------------------+
|                                                   |
|                    数据层                         |
|                                                   |
|  +-------------+  +-------------+  +-------------+|
|  |             |  |             |  |             ||
|  |    用户      |  |    消息     |  |    班级     ||
|  |   集合       |  |    集合     |  |    集合     ||
|  |             |  |             |  |             ||
|  +-------------+  +-------------+  +-------------+|
|                                                   |
|  +-------------+  +-------------+                 |
|  |             |  |             |                 |
|  |  阅读记录    |  |  系统日志   |                 |
|  |    集合      |  |    集合     |                 |
|  |             |  |             |                 |
|  +-------------+  +-------------+                 |
|                                                   |
|                MongoDB 数据库                     |
|                                                   |
+---------------------------------------------------+
```

## 系统流程图

### 消息发送和接收流程

```
+------------+        +-------------+        +-------------+
|            |  发送   |             |  推送   |             |
|   老师端    +-------->  后端服务   +--------->  学生大屏端  |
| (Vue.js)   |  消息   |             |  消息   | (Vue.js)    |
+------------+        +------+------+        +------+------+
                             ^                      |
                             |                      |
                             |        确认已读       |
                             +----------------------+
```

### 用户认证流程

```
+------------+        +-------------+        +-------------+
|            |  提交   |             |  验证   |             |
|    用户     +-------->   认证服务   +--------->   生成JWT   |
|  (Vue.js)  |  凭据   |             |  成功   |     令牌     |
+------+-----+        +-------------+        +------+------+
       ^                                            |
       |                                            |
       |                返回JWT令牌                  |
       +--------------------------------------------+
```

### 消息阅读状态跟踪流程

```
+------------+        +-------------+        +-------------+
|            |  点击   |             |  更新   |             |
|  学生大屏端  +-------->  后端服务   +--------->  数据库     |
|  (Vue.js)  |  确认   |             |  状态   |             |
+------------+        +------+------+        +-------------+
                             |
                             v
                      +-------------+        +-------------+
                      |             |  推送   |             |
                      |  WebSocket  +--------->   老师端    |
                      |    服务     |  状态   |  (Vue.js)   |
                      +-------------+        +-------------+
```

## 技术组件关系图

```
+---------------------+      +---------------------+
|                     |      |                     |
|       Vue.js        <------>     Electron        |
|      前端框架        |      |     打包工具        |
|                     |      |                     |
+----------+----------+      +---------------------+
           |
           v
+----------+----------+      +---------------------+
|                     |      |                     |
|     Socket.io       <------>   Express.js        |
|     客户端          |      |    Web框架         |
|                     |      |                     |
+---------------------+      +----------+----------+
                                       |
                                       v
+---------------------+      +----------+----------+
|                     |      |                     |
|      Socket.io      <------>   MongoDB原生驱动   |
|      服务端         |      |                     |
|                     |      |                     |
+---------------------+      +----------+----------+
                                       |
                                       v
                             +----------+----------+
                             |                     |
                             |     MongoDB         |
                             |     数据库          |
                             |                     |
                             +---------------------+
```

## Vue.js组件架构

```
+--------------------------------------------------------------+
|                                                              |
|                         App.vue                              |
|                                                              |
+--------------------------------------------------------------+
           |                |                  |
           v                v                  v
+-------------------+ +----------------+ +-------------------+
|                   | |                | |                   |
|   管理员模块       | |    老师模块     | |   学生大屏模块     |
|                   | |                | |                   |
+-------------------+ +----------------+ +-------------------+
   |     |     |        |     |     |       |      |      |
   v     v     v        v     v     v       v      v      v
+-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+
|     | |     | |     | |     | |     | |     | |     | |     |
|用户 | |班级 | |系统 | |消息 | |班级 | |统计 | |弹幕 | |历史 |
|管理 | |管理 | |设置 | |管理 | |查看 | |分析 | |显示 | |消息 |
|     | |     | |     | |     | |     | |     | |     | |     |
+-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+
```

## Vue.js状态管理架构

```
+------------------------------------------+
|                                          |
|             Vuex/Pinia Store             |
|                                          |
+------------------------------------------+
         |        |        |        |
         v        v        v        v
+----------+ +----------+ +----------+ +----------+
|          | |          | |          | |          |
| 用户模块  | | 班级模块  | | 消息模块  | | 系统模块  |
|          | |          | |          | |          |
+----------+ +----------+ +----------+ +----------+
``` 